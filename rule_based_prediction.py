# Tamil Vedic Astrology - Rule-Based Prediction System
# NO API NEEDED - 100% FREE, works offline

import json
from datetime import datetime

class TamilRuleBasedPrediction:
    """Generate Tamil astrology predictions using traditional Vedic rules - NO API needed"""
    
    def __init__(self):
        self.planet_effects = self._build_planet_effects()
        self.dasha_effects = self._build_dasha_effects()
        self.rasi_effects = self._build_rasi_effects()
        self.bhava_effects = self._build_bhava_effects()
    
    def _build_planet_effects(self):
        return {
            "роЪрпВро░ро┐ропройрпН": {
                "роиро▓рпНро▓": "роЕро░роЪро╛роЩрпНроХ ро╡рпЗро▓рпИ, рокродро╡ро┐ роЙропро░рпНро╡рпБ, родроирпНродрпИропро┐ройрпН роЖроЪрпАро░рпНро╡ро╛родроорпН, рокрпБроХро┤рпН роХро┐роЯрпИроХрпНроХрпБроорпН.",
                "рокрпКродрпБ": "роЪрпБроп роорпБропро▒рпНроЪро┐ропро╛ро▓рпН ро╡рпЖро▒рпНро▒ро┐, родро▓рпИроорпИрокрпН рокрогрпНрокрпБ ро╡ро│ро░рпБроорпН.",
                "рокро░ро┐роХро╛ро░роорпН": "роЮро╛ропро┐ро▒рпНро▒рпБроХрпНроХро┐ро┤роорпИ роЪрпВро░ро┐роп роирооро╕рпНроХро╛ро░роорпН, роЖродро┐родрпНроп ро╣ро┐ро░рпБродропроорпН рокроЯро┐роХрпНроХро╡рпБроорпН."
            },
            "роЪроирпНродро┐ро░ройрпН": {
                "роиро▓рпНро▓": "роорой роЕроорпИродро┐, родро╛ропро┐ройрпН роЖроЪрпАро░рпНро╡ро╛родроорпН, роиро▓рпНро▓ роЙро▒ро╡рпБроХро│рпН, ро╡рпЖро│ро┐роиро╛роЯрпНроЯрпБ рокропрогроорпН.",
                "рокрпКродрпБ": "роЙрогро░рпНро╡рпБроХро│рпН роорпЗро▓рпЛроЩрпНроХрпБроорпН, роХро▒рпНрокройрпИ родро┐ро▒ройрпН роЕродро┐роХро░ро┐роХрпНроХрпБроорпН.",
                "рокро░ро┐роХро╛ро░роорпН": "родро┐роЩрпНроХроЯрпНроХро┐ро┤роорпИ ро╡ро┐ро░родроорпН, роЪро┐ро╡ ро╡ро┤ро┐рокро╛роЯрпБ роЪрпЖропрпНропро╡рпБроорпН."
            },
            "роЪрпЖро╡рпНро╡ро╛ропрпН": {
                "роиро▓рпНро▓": "родрпИро░ро┐ропроорпН роЕродро┐роХро░ро┐роХрпНроХрпБроорпН, роиро┐ро▓роорпН ро╡ро╛роЩрпНроХрпБро╡рпАро░рпНроХро│рпН, роЪроХрпЛродро░ роЙродро╡ро┐ роХро┐роЯрпИроХрпНроХрпБроорпН.",
                "рокрпКродрпБ": "роЖро▒рпНро▒ро▓рпН роЕродро┐роХроорпН, ро╡ро┐ро░рпИро╡ро╛рой роорпБроЯро┐ро╡рпБроХро│рпН роОроЯрпБрокрпНрокрпАро░рпНроХро│рпН.",
                "рокро░ро┐роХро╛ро░роорпН": "роЪрпЖро╡рпНро╡ро╛ропрпНроХрпНроХро┐ро┤роорпИ ро╣ройрпБрооро╛ройрпН ро╡ро┤ро┐рокро╛роЯрпБ, роЪрпБрокрпНро░роорогро┐роп ро╕рпНро╡ро╛рооро┐ роХрпЛро╡ро┐ро▓рпН роЪрпЖро▓рпНро▓ро╡рпБроорпН."
            },
            "рокрпБродройрпН": {
                "роиро▓рпНро▓": "роХро▓рпНро╡ро┐ропро┐ро▓рпН роЪро┐ро▒рокрпНрокрпБ, ро╡рогро┐роХродрпНродро┐ро▓рпН ро▓ро╛рокроорпН, родрпКроЯро░рпНрокрпБ родро┐ро▒ройрпН роорпЗроорпНрокроЯрпБроорпН.",
                "рокрпКродрпБ": "рокрпБродрпНродро┐роЪро╛ро▓ро┐родрпНродройроорпН ро╡рпЖро│ро┐рокрпНрокроЯрпБроорпН, рокрпБродро┐роп ро╡ро┐ро╖ропроЩрпНроХро│рпН роХро▒рпНрокрпАро░рпНроХро│рпН.",
                "рокро░ро┐роХро╛ро░роорпН": "рокрпБродройрпНроХро┐ро┤роорпИ ро╡ро┐ро╖рпНрогрпБ роЪро╣ро╕рпНро░роиро╛роороорпН рокроЯро┐роХрпНроХро╡рпБроорпН."
            },
            "роХрпБро░рпБ": {
                "роиро▓рпНро▓": "роЖроЪро┐ро░ро┐ропро░рпН роЖроЪрпАро░рпНро╡ро╛родроорпН, роХрпБро┤роирпНродрпИ рокро╛роХрпНроХро┐ропроорпН, роЪрпЖро▓рпНро╡роорпН роЪрпЗро░рпБроорпН, роЮро╛ройроорпН ро╡ро│ро░рпБроорпН.",
                "рокрпКродрпБ": "роиро▓рпНро▓ ро╡ро┤ро┐роХро╛роЯрпНроЯрпБродро▓рпН роХро┐роЯрпИроХрпНроХрпБроорпН, родро░рпНроо роХро╛ро░ро┐ропроЩрпНроХро│рпН роЪрпЖропрпНро╡рпАро░рпНроХро│рпН.",
                "рокро░ро┐роХро╛ро░роорпН": "ро╡ро┐ропро╛ро┤роХрпНроХро┐ро┤роорпИ роХрпБро░рпБ ро╕рпНродрпЛродрпНродро┐ро░роорпН, родроЯрпНроЪро┐рогро╛роорпВро░рпНродрпНродро┐ ро╡ро┤ро┐рокро╛роЯрпБ."
            },
            "роЪрпБроХрпНроХро┐ро░ройрпН": {
                "роиро▓рпНро▓": "родро┐ро░рпБроорог ропрпЛроХроорпН, роХро╛родро▓рпН ро╡рпЖро▒рпНро▒ро┐, роХро▓рпИ родро┐ро▒ройрпН, роЖроЯроорпНрокро░ ро╡ро╛ро┤рпНроХрпНроХрпИ.",
                "рокрпКродрпБ": "роЕро┤роХрпБ роЙрогро░рпНро╡рпБ роорпЗроорпНрокроЯрпБроорпН, роЪрпБроХ рокрпЛроХроЩрпНроХро│рпН роЕройрпБрокро╡ро┐рокрпНрокрпАро░рпНроХро│рпН.",
                "рокро░ро┐роХро╛ро░роорпН": "ро╡рпЖро│рпНро│ро┐роХрпНроХро┐ро┤роорпИ ро▓роХрпНро╖рпНрооро┐ рокрпВроЬрпИ, рооро╣ро╛ро▓роХрпНро╖рпНрооро┐ роЕро╖рпНроЯроХроорпН."
            },
            "роЪройро┐": {
                "роиро▓рпНро▓": "роХроЯро┐рой роЙро┤рпИрокрпНрокро┐ройрпН рокро▓ройрпН, роирпАрогрпНроЯ роЖропрпБро│рпН, рокрпКро▒рпБроорпИ ро╡ро│ро░рпБроорпН.",
                "рокрпКродрпБ": "родро╛роородрооро╛рой рокро▓ройрпНроХро│рпН, роЖройро╛ро▓рпН роиро┐ро▓рпИропро╛рой ро╡рпЖро▒рпНро▒ро┐.",
                "рокро░ро┐роХро╛ро░роорпН": "роЪройро┐роХрпНроХро┐ро┤роорпИ ро╡ро┐ро░родроорпН, ро╣ройрпБрооро╛ройрпН роЪро╛ро▓рпАроЪро╛, роОро│рпН родро╛ройроорпН."
            },
            "ро░ро╛роХрпБ": {
                "роиро▓рпНро▓": "родро┐роЯрпАро░рпН роЕродро┐ро░рпНро╖рпНроЯроорпН, ро╡рпЖро│ро┐роиро╛роЯрпНроЯрпБ ро╡ро╛ропрпНрокрпНрокрпБ, родрпКро┤ро┐ро▓рпНроирпБроЯрпНрок родрпБро▒рпИропро┐ро▓рпН ро╡рпЖро▒рпНро▒ро┐.",
                "рокрпКродрпБ": "роОродро┐ро░рпНрокро╛ро░ро╛род рооро╛ро▒рпНро▒роЩрпНроХро│рпН, рокрпБродро┐роп роЕройрпБрокро╡роЩрпНроХро│рпН.",
                "рокро░ро┐роХро╛ро░роорпН": "ро░ро╛роХрпБ роХро╛ро▓родрпНродро┐ро▓рпН родрпБро░рпНроХро╛ рокрпВроЬрпИ, роиро╛роХро░рпН роХрпЛро╡ро┐ро▓рпН роЪрпЖро▓рпНро▓ро╡рпБроорпН."
            },
            "роХрпЗродрпБ": {
                "роиро▓рпНро▓": "роЖройрпНроорпАроХ ро╡ро│ро░рпНроЪрпНроЪро┐, роорпЛроЯрпНроЪ рооро╛ро░рпНроХрпНроХроорпН, роЙро│рпНро│рпБрогро░рпНро╡рпБ роЕродро┐роХро░ро┐роХрпНроХрпБроорпН.",
                "рокрпКродрпБ": "рокро▒рпНро▒ро▒рпНро▒ родройрпНроорпИ, роЖро┤рпНроирпНрод роЪро┐роирпНродройрпИ.",
                "рокро░ро┐роХро╛ро░роорпН": "роХрогрокродро┐ ро╣рпЛроороорпН, ро╡ро┐роиро╛ропроХро░рпН ро╡ро┤ро┐рокро╛роЯрпБ."
            }
        }
    
    def _build_dasha_effects(self):
        return {
            "роХрпЗродрпБ": "роЖройрпНроорпАроХ роЪро┐роирпНродройрпИ роЕродро┐роХро░ро┐роХрпНроХрпБроорпН. роОродро┐ро░рпНрокро╛ро░ро╛род рооро╛ро▒рпНро▒роЩрпНроХро│рпН ро╡ро░ро▓ро╛роорпН. рокро┤рпИроп роХро░рпНрооро╛роХрпНроХро│рпН роорпБроЯро┐ропрпБроорпН.",
            "роЪрпБроХрпНроХро┐ро░ройрпН": "роЪрпБроХ рокрпЛроХроЩрпНроХро│рпН роЕройрпБрокро╡ро┐рокрпНрокрпАро░рпНроХро│рпН. родро┐ро░рпБроорогроорпН, роХро╛родро▓рпН ро╡рпЖро▒рпНро▒ро┐. роХро▓рпИ родрпБро▒рпИропро┐ро▓рпН роорпБройрпНройрпЗро▒рпНро▒роорпН.",
            "роЪрпВро░ро┐ропройрпН": "роЕро░роЪро╛роЩрпНроХ роЪроорпНрокроирпНродрооро╛рой роХро╛ро░ро┐ропроЩрпНроХро│рпН ро╡рпЖро▒рпНро▒ро┐. родроирпНродрпИропро┐ройрпН роЖродро░ро╡рпБ. рокродро╡ро┐ роЙропро░рпНро╡рпБ ро╡ро╛ропрпНрокрпНрокрпБ.",
            "роЪроирпНродро┐ро░ройрпН": "роорой роиро┐роорпНроородро┐ роХро┐роЯрпИроХрпНроХрпБроорпН. родро╛ропро┐ройрпН роЖроЪрпАро░рпНро╡ро╛родроорпН. ро╡рпЖро│ро┐роиро╛роЯрпНроЯрпБ рокропрогроорпН роЪро╛родрпНродро┐ропроорпН.",
            "роЪрпЖро╡рпНро╡ро╛ропрпН": "родрпИро░ро┐ропрооро╛рой роорпБроЯро┐ро╡рпБроХро│рпН роОроЯрпБрокрпНрокрпАро░рпНроХро│рпН. роиро┐ро▓роорпН, ро╡рпАроЯрпБ ро╡ро╛роЩрпНроХрпБроорпН ропрпЛроХроорпН. роЪроХрпЛродро░ роЙродро╡ро┐.",
            "ро░ро╛роХрпБ": "родро┐роЯрпАро░рпН рооро╛ро▒рпНро▒роЩрпНроХро│рпН, ро╡рпЖро│ро┐роиро╛роЯрпНроЯрпБ ро╡ро╛ропрпНрокрпНрокрпБ. родрпКро┤ро┐ро▓рпНроирпБроЯрпНрок родрпБро▒рпИропро┐ро▓рпН ро╡рпЖро▒рпНро▒ро┐. роЖройро╛ро▓рпН роХро╡ройроорпН родрпЗро╡рпИ.",
            "роХрпБро░рпБ": "рооро┐роХро╡рпБроорпН роЪро┐ро▒роирпНрод роХро╛ро▓роорпН. роХрпБро┤роирпНродрпИ рокро╛роХрпНроХро┐ропроорпН, роЪрпЖро▓рпНро╡роорпН, роЮро╛ройроорпН роОро▓рпНро▓ро╛роорпН роХро┐роЯрпИроХрпНроХрпБроорпН.",
            "роЪройро┐": "роХроЯро┐рой роЙро┤рпИрокрпНрокрпБ родрпЗро╡рпИ. родро╛роородрооро╛рой рокро▓ройрпНроХро│рпН. роЖройро╛ро▓рпН роиро┐ро▓рпИропро╛рой ро╡рпЖро▒рпНро▒ро┐ роХро┐роЯрпИроХрпНроХрпБроорпН.",
            "рокрпБродройрпН": "роХро▓рпНро╡ро┐, ро╡рогро┐роХроорпН, родрпКроЯро░рпНрокрпБ родрпБро▒рпИропро┐ро▓рпН ро╡рпЖро▒рпНро▒ро┐. рокрпБродро┐роп родро┐ро▒ройрпНроХро│рпН роХро▒рпНрокрпАро░рпНроХро│рпН."
        }
    
    def _build_rasi_effects(self):
        return {
            "роорпЗро╖роорпН": "родро▓рпИроорпИрокрпН рокрогрпНрокрпБ, родрпИро░ро┐ропроорпН, роорпБройрпНройрпЛроЯро┐ роЪро┐роирпНродройрпИ роЙро│рпНро│ро╡ро░рпНроХро│рпН.",
            "ро░ро┐ро╖рокроорпН": "роиро┐ро▓рпИропро╛рой роЪро┐роирпНродройрпИ, роЪрпЖро▓рпНро╡роорпН роЪрпЗро░рпНроХрпНроХрпБроорпН родро┐ро▒ройрпН, роХро▓рпИ роЖро░рпНро╡роорпН.",
            "рооро┐родрпБройроорпН": "рокрпБродрпНродро┐роЪро╛ро▓ро┐, родрпКроЯро░рпНрокрпБ родро┐ро▒ройрпН, рокро▓ родро┐ро▒роорпИроХро│рпН роХрпКрогрпНроЯро╡ро░рпНроХро│рпН.",
            "роХроЯроХроорпН": "роЙрогро░рпНро╡рпБрокрпВро░рпНро╡рооро╛рой, роХрпБроЯрпБроорпНрокрокрпН рокро▒рпНро▒рпБ, рокро╛родрпБроХро╛рокрпНрокрпБ роЙрогро░рпНро╡рпБ.",
            "роЪро┐роорпНроороорпН": "ро░ро╛роЬропрпЛроХроорпН, родро▓рпИроорпИ, роХроорпНрокрпАро░роорпН, рокрпБроХро┤рпН рокрпЖро▒рпБро╡ро╛ро░рпНроХро│рпН.",
            "роХройрпНройро┐": "роЖро░ро╛ропрпНроЪрпНроЪро┐ рооройрокрпНрокро╛ройрпНроорпИ, роЪрпБродрпНродроорпН, роЪрпЗро╡рпИ рооройрокрпНрокро╛ройрпНроорпИ.",
            "родрпБро▓ро╛роорпН": "роЪроороиро┐ро▓рпИ, роирпАродро┐ роЙрогро░рпНро╡рпБ, роХро▓рпИ роЖро░рпНро╡роорпН, роХрпВроЯрпНроЯро╛рогрпНроорпИ.",
            "ро╡ро┐ро░рпБроЪрпНроЪро┐роХроорпН": "роЖро┤рпНроирпНрод роЪро┐роирпНродройрпИ, ро░роХроЪро┐ропроорпН роХро╛рокрпНрокро╡ро░рпН, рооро╛ро▒рпНро▒родрпНродрпИ ро╡ро┐ро░рпБроорпНрокрпБро╡ро░рпН.",
            "родройрпБроЪрпБ": "родродрпНродрпБро╡ роЪро┐роирпНродройрпИ, рокропрогроорпН, роЙропро░рпН роХро▓рпНро╡ро┐, роирпЗро░рпНроорпИ.",
            "роороХро░роорпН": "роХроЯро┐рой роЙро┤рпИрокрпНрокрпБ, рокрпКро▒рпБрокрпНрокрпБ, роиро┐ро░рпНро╡ро╛роХ родро┐ро▒ройрпН, ро▓роЯрпНроЪро┐ропроорпН.",
            "роХрпБроорпНрокроорпН": "рокрпБродрпБроорпИ роЪро┐роирпНродройрпИ, роЪроорпВроХ роЪрпЗро╡рпИ, роЪрпБродроирпНродро┐ро░ роОрогрпНрогроорпН.",
            "роорпАройроорпН": "роХро▒рпНрокройрпИ родро┐ро▒ройрпН, роЖройрпНроорпАроХроорпН, роЗро░роХрпНроХроорпН, роХро▓рпИ роЖро░рпНро╡роорпН."
        }
    
    def _build_bhava_effects(self):
        return {
            1: "роЙроЯро▓рпН роЖро░рпЛроХрпНроХро┐ропроорпН, роЖро│рпБроорпИ, родройрпНройроорпНрокро┐роХрпНроХрпИ рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            2: "роХрпБроЯрпБроорпНрокроорпН, рокрогроорпН, ро╡ро╛роХрпНроХрпБ роЪроХрпНродро┐ рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            3: "роЪроХрпЛродро░ро░рпН, родрпИро░ро┐ропроорпН, роХрпБро▒рпБроХро┐роп рокропрогроорпН рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            4: "родро╛ропрпН, ро╡рпАроЯрпБ, ро╡ро╛роХройроорпН, роиро┐ро▓роорпН рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            5: "роХрпБро┤роирпНродрпИ, роХро▓рпНро╡ро┐, рокрпБродрпНродро┐, рокрпВро░рпНро╡ рокрпБрогрпНрогро┐ропроорпН рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            6: "роОродро┐ро░ро┐, роирпЛропрпН, роХроЯройрпН, ро╡рпЗро▓рпИропро╛роЯрпНроХро│рпН рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            7: "родро┐ро░рпБроорогроорпН, роХрпВроЯрпНроЯро╛ро│ро┐, ро╡ро┐ропро╛рокро╛ро░роорпН рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            8: "роЖропрпБро│рпН, рооро░рогроорпН, рооро▒рпИро╡ро╛рой ро╡ро┐ро╖ропроЩрпНроХро│рпН рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            9: "родроирпНродрпИ, рокро╛роХрпНроХро┐ропроорпН, родро░рпНроороорпН, роирпАрогрпНроЯ рокропрогроорпН рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            10: "родрпКро┤ро┐ро▓рпН, рокродро╡ро┐, рокрпБроХро┤рпН, роЪроорпВроХ роЕроирпНродро╕рпНродрпБ рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            11: "ро▓ро╛рокроорпН, роирогрпНрокро░рпНроХро│рпН, роЖроЪрпИроХро│рпН роиро┐ро▒рпИро╡рпЗро▒рпБродро▓рпН рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН.",
            12: "роЪрпЖро▓ро╡рпБ, ро╡рпЖро│ро┐роиро╛роЯрпБ, роорпЛроЯрпНроЪроорпН, роЗро┤рокрпНрокрпБ рокро▒рпНро▒ро┐роп рокро▓ройрпНроХро│рпН."
        }
    
    def generate_prediction(self, chart_data, question_type="рокрпКродрпБ", specific_question=None):
        """Generate prediction based on chart data using Vedic rules"""
        
        prediction_parts = []
        
        # 1. Basic Info
        rasi = chart_data.get("ро░ро╛роЪро┐", "")
        nakshatra = chart_data.get("роироЯрпНроЪродрпНродро┐ро░роорпН", "")
        lagna = chart_data.get("ро▓роХрпНройроорпН", "")
        
        prediction_parts.append(f"## ЁЯФо роЬро╛родроХ рокро▓ройрпН ро╡ро┐ро│роХрпНроХроорпН\n")
        prediction_parts.append(f"**ро░ро╛роЪро┐:** {rasi} | **роироЯрпНроЪродрпНродро┐ро░роорпН:** {nakshatra} | **ро▓роХрпНройроорпН:** {lagna}\n")
        
        # 2. Rasi Effect
        if rasi in self.rasi_effects:
            prediction_parts.append(f"\n### ЁЯМЯ ро░ро╛роЪро┐ рокро▓ройрпН\n{self.rasi_effects[rasi]}\n")
        
        # 3. Current Dasha Effect
        dasha_info = chart_data.get("родроЪро╛_рокрпБроХрпНродро┐", {})
        current_dasha = dasha_info.get("родро▒рпНрокрпЛродрпИроп_родроЪро╛", "")
        current_bhukti = dasha_info.get("родро▒рпНрокрпЛродрпИроп_рокрпБроХрпНродро┐", "")
        
        if current_dasha:
            dasha_planet = current_dasha.split()[0] if current_dasha else ""
            prediction_parts.append(f"\n### ЁЯУЕ родро▒рпНрокрпЛродрпИроп родроЪро╛-рокрпБроХрпНродро┐ рокро▓ройрпН\n")
            prediction_parts.append(f"**{current_dasha}** роироЯрпИрокрпЖро▒рпБроХро┐ро▒родрпБ.\n")
            
            if dasha_planet in self.dasha_effects:
                prediction_parts.append(f"{self.dasha_effects[dasha_planet]}\n")
            
            if current_bhukti:
                bhukti_planet = current_bhukti.split()[0] if current_bhukti else ""
                prediction_parts.append(f"\n**рокрпБроХрпНродро┐:** {current_bhukti}\n")
                if bhukti_planet in self.planet_effects:
                    prediction_parts.append(f"{self.planet_effects[bhukti_planet]['рокрпКродрпБ']}\n")
        
        # 4. Planet-wise predictions
        planets = chart_data.get("роХро┐ро░роХ_роиро┐ро▓рпИроХро│рпН", {})
        if planets:
            prediction_parts.append(f"\n### ЁЯкР роХро┐ро░роХ рокро▓ройрпНроХро│рпН\n")
            for planet, info in planets.items():
                if planet in self.planet_effects:
                    rasi_pos = info.get("ро░ро╛роЪро┐", "") if isinstance(info, dict) else ""
                    prediction_parts.append(f"**{planet}** ({rasi_pos}): {self.planet_effects[planet]['рокрпКродрпБ']}\n")
        
        # 5. Question-specific prediction
        if question_type:
            prediction_parts.append(f"\n### ЁЯТб {question_type} рокро▒рпНро▒ро┐роп рокро▓ройрпН\n")
            if question_type == "родро┐ро░рпБроорогроорпН":
                prediction_parts.append("роЪрпБроХрпНроХро┐ро░ройрпН рооро▒рпНро▒рпБроорпН 7роорпН рокро╛ро╡ роиро┐ро▓рпИропрпИ рокрпКро▒рпБродрпНродрпБ родро┐ро░рпБроорог ропрпЛроХроорпН роЙро│рпНро│родрпБ. ")
                prediction_parts.append("роХрпБро░рпБ рокро╛ро░рпНро╡рпИ роЗро░рпБроирпНродро╛ро▓рпН роиро▓рпНро▓ ро╡ро╛ро┤рпНроХрпНроХрпИродрпН родрпБрогрпИ роХро┐роЯрпИроХрпНроХрпБроорпН.\n")
            elif question_type == "родрпКро┤ро┐ро▓рпН":
                prediction_parts.append("10роорпН рокро╛ро╡ роЕродро┐рокродро┐ рооро▒рпНро▒рпБроорпН роЪройро┐ роиро┐ро▓рпИропрпИ рокрпКро▒рпБродрпНродрпБ родрпКро┤ро┐ро▓рпН ро╡рпЖро▒рпНро▒ро┐ роЙрогрпНроЯрпБ. ")
                prediction_parts.append("рокрпБродройрпН рокро▓рооро╛роХ роЗро░рпБроирпНродро╛ро▓рпН ро╡рогро┐роХродрпНродро┐ро▓рпН ро▓ро╛рокроорпН.\n")
            elif question_type == "роЖро░рпЛроХрпНроХро┐ропроорпН":
                prediction_parts.append("ро▓роХрпНройро╛родро┐рокродро┐ рооро▒рпНро▒рпБроорпН 6роорпН рокро╛ро╡ роиро┐ро▓рпИропрпИ рокрпКро▒рпБродрпНродрпБ роЖро░рпЛроХрпНроХро┐ропроорпН роЕроорпИропрпБроорпН. ")
                prediction_parts.append("роЪрпВро░ро┐ропройрпН рокро▓рооро╛роХ роЗро░рпБроирпНродро╛ро▓рпН роиро▓рпНро▓ роЙроЯро▓рпН роиро▓роорпН.\n")
            else:
                prediction_parts.append("роХро┐ро░роХ роиро┐ро▓рпИроХро│ро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН рокрпКродрпБро╡ро╛рой роиро▓рпНро▓ рокро▓ройрпНроХро│рпН роЙро│рпНро│рой. ")
                prediction_parts.append("родроЪро╛-рокрпБроХрпНродро┐ роХро╛ро▓родрпНродрпИ роХро╡ройро┐родрпНродрпБ роЪрпЖропро▓рпНрокроЯрпБроЩрпНроХро│рпН.\n")
        
        # 6. Remedies
        prediction_parts.append(f"\n### ЁЯЩП рокро░ро┐роХро╛ро░роЩрпНроХро│рпН\n")
        if current_dasha:
            dasha_planet = current_dasha.split()[0] if current_dasha else ""
            if dasha_planet in self.planet_effects:
                prediction_parts.append(f"**{dasha_planet} родроЪро╛ рокро░ро┐роХро╛ро░роорпН:** {self.planet_effects[dasha_planet]['рокро░ро┐роХро╛ро░роорпН']}\n")
        
        prediction_parts.append("\n**рокрпКродрпБ рокро░ро┐роХро╛ро░роЩрпНроХро│рпН:**\n")
        prediction_parts.append("- родро┐ройроорпБроорпН роХро╛ро▓рпИропро┐ро▓рпН роЪрпВро░ро┐роп роирооро╕рпНроХро╛ро░роорпН роЪрпЖропрпНропро╡рпБроорпН\n")
        prediction_parts.append("- ро╡ро╛ро░роорпН роТро░рпБ роорпБро▒рпИ роХрпЛро╡ро┐ро▓рпН роЪрпЖро▓рпНро▓ро╡рпБроорпН\n")
        prediction_parts.append("- рокрпЖро░ро┐ропро╡ро░рпНроХро│рпИ роородро┐родрпНродрпБ роЖроЪрпАро░рпНро╡ро╛родроорпН рокрпЖро▒ро╡рпБроорпН\n")
        prediction_parts.append("- родро╛ройроорпН, родро░рпНроороорпН роЪрпЖропрпНропро╡рпБроорпН\n")
        
        # 7. Future outlook
        prediction_parts.append(f"\n### ЁЯФо роОродро┐ро░рпНроХро╛ро▓ рокро▓ройрпН (роЕроЯрпБродрпНрод 1 ро╡ро░рпБроЯроорпН)\n")
        prediction_parts.append("родроЪро╛-рокрпБроХрпНродро┐ рооро╛ро▒рпНро▒роЩрпНроХро│ро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН ро╡ро╛ро┤рпНроХрпНроХрпИропро┐ро▓рпН роорпБройрпНройрпЗро▒рпНро▒роорпН роЗро░рпБроХрпНроХрпБроорпН. ")
        prediction_parts.append("роХроЯро┐рой роЙро┤рпИрокрпНрокрпБ рооро▒рпНро▒рпБроорпН роироорпНрокро┐роХрпНроХрпИропрпБроЯройрпН роЪрпЖропро▓рпНрокроЯрпНроЯро╛ро▓рпН ро╡рпЖро▒рпНро▒ро┐ роиро┐роЪрпНроЪропроорпН.\n")
        
        return "".join(prediction_parts)
